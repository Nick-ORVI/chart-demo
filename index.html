<!DOCTYPE html>
<html>
<head>
  <title>Ohio School Disrict Real Funding</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
    }
  
    h2 {
      text-align: center;
      padding: 10px;
    }
  
    canvas {
    width: 80%;
    max-width: 800px;
    display: block;
    margin: 0 auto;
  }
  </style>
</head>
<body>
  <div style="text-align: center; padding: 20px;">
    <img src="ORVIlogo.png" alt="Organization Logo" style="height: 60px; vertical-align: middle; margin-right: 10px;">
    <span style="font-size: 24px; font-weight: bold;">Ohio School District State Funding, Inflation Adjusted</span>
  </div>

  <select id="dataSelect" style="display: block; margin: 0 auto;"></select>
  <canvas id="myChart" style="background-color: #f9f6f6;"></canvas>
  <canvas id="myChart" width="400"></canvas>
  <p style="text-align: center; font-size: 14px; margin-top: 20px;">
    Data Sources: Ohio Department of Education and Workforce, Ohio River Valley Institute Analysis
  </p>

  <script>
    let chart;
    let parsedData = {};

    function createChart(labels, data) {
      const ctx = document.getElementById('myChart').getContext('2d');
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Real Net State Funding',
            data: data,
            borderColor: 'blue',
            tension: 0.1
          }]
        },
        options: {
  scales: {
    y: {
      ticks: {
        callback: function(value) {
          return '$' + value;
        }
      },
      title: {
        display: true,
        text: 'Value'
      }
    }
  }
}
      });
    }

    function updateChart(data) {
      chart.data.datasets[0].data = data;
      chart.update();
    }

    function loadCSV() {
      fetch('data.csv')
        .then(response => response.text())
        .then(csv => {
          const result = Papa.parse(csv, { header: true });
          const labels = Object.keys(result.data[0]).slice(1);

          result.data.forEach(row => {
            if (row.District) {
              parsedData[row.District] = labels.map(label => parseFloat(row[label]));
            }
          });

          const dropdown = document.getElementById('dataSelect');
          Object.keys(parsedData).forEach(District => {
            const option = document.createElement('option');
            option.value = District;
            option.textContent = District;
            dropdown.appendChild(option);
          });

          createChart(labels, parsedData[dropdown.value]);

          dropdown.addEventListener('change', function () {
            updateChart(parsedData[this.value]);
          });
        });
    }

    loadCSV();
  </script>
</body>
</html>
